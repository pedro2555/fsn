<html><head></head><body><div hidden="" by-polymer-bundler=""><script src="https://www.gstatic.com/charts/loader.js"></script><script>(function(){'use strict';function a(a){return google[0===a.indexOf('md-')?c.CHARTS:c.VIS]}var b='corechart',c={CHARTS:'charts',VIS:'visualization'},d={area:{ctor:'AreaChart'},bar:{ctor:'BarChart'},"md-bar":{ctor:'Bar',pkg:'bar'},bubble:{ctor:'BubbleChart'},calendar:{ctor:'Calendar',pkg:'calendar'},candlestick:{ctor:'CandlestickChart'},column:{ctor:'ColumnChart'},combo:{ctor:'ComboChart'},gauge:{ctor:'Gauge',pkg:'gauge'},geo:{ctor:'GeoChart'},histogram:{ctor:'Histogram'},line:{ctor:'LineChart'},"md-line":{ctor:'Line',pkg:'line'},org:{ctor:'OrgChart',pkg:'orgchart'},pie:{ctor:'PieChart'},sankey:{ctor:'Sankey',pkg:'sankey'},scatter:{ctor:'ScatterChart'},"md-scatter":{ctor:'Scatter',pkg:'scatter'},"stepped-area":{ctor:'SteppedAreaChart'},table:{ctor:'Table',pkg:'table'},timeline:{ctor:'Timeline',pkg:'timeline'},treemap:{ctor:'TreeMap',pkg:'treemap'},wordtree:{ctor:'WordTree',namespace:c.VIS,pkg:'wordtree'}},e={},f={},g={};Polymer({is:'google-chart-loader',properties:{packages:{type:Array,value:function(){return[]},observer:'_loadPackages'},type:{type:String,observer:'_loadPackageForType'}},get _corePackage(){return f[b]?f[b]:this._loadPackages([b]).then(function(a){return a[0]})},_loadPackagesDebounce:function(){this.debounce('loadPackages',function(){var a=Object.keys(e);a.length&&(e={},google.charts.load('current',{packages:a,language:document.documentElement.lang||'en'}),google.charts.setOnLoadCallback(function(){a.forEach(function(a){this.fire('loaded',a),g[a](google.visualization)}.bind(this))}.bind(this)))},100)},_loadPackages:function(a){var b=[];return a.forEach(function(a){f[a]||(e[a]=!0,f[a]=new Promise(function(b){g[a]=b}),this._loadPackagesDebounce()),b.push(f[a])}.bind(this)),Promise.all(b)},_loadPackageForType:function(c){var e=d[c];return e?this._loadPackages([e.pkg||b]).then(function(){var b=google[e.namespace]||a(c);return b[e.ctor]}):Promise.reject('This chart type is not yet supported: '+c)},create:function(a,b){return this._loadPackageForType(a).then(function(a){return new a(b)})},fireOnChartEvent:function(a,b,c){return this._corePackage.then(function(d){var e=c?d.events.addOneTimeListener:d.events.addListener;e(a,b,function(c){this.fire('google-chart-'+b,{chart:a,data:c})}.bind(this))}.bind(this))},dataTable:function(a){return this._corePackage.then(function(b){if(null==a)return new b.DataTable;return a.getNumberOfRows?a:a.cols?new b.DataTable(a):0<a.length?b.arrayToDataTable(a):0===a.length?Promise.reject('Data was empty.'):Promise.reject('Data format was not recognized.')})},dataView:function(a){return this._corePackage.then(function(b){return new b.DataView(a)})},query:function(a,b){return this._corePackage.then(function(c){return new c.Query(a,b)})}})})();</script><dom-module id="google-chart-styles" assetpath="../bower_components/google-chart/"><template><style>:host{display:-webkit-flex;display:-ms-flex;display:flex;margin:0;padding:0;width:400px;height:300px;}:host([type="gauge"]){width:300px;height:300px;}#chartdiv{width:100%;}</style></template></dom-module><dom-module id="google-chart" assetpath="../bower_components/google-chart/"><template><style include="google-chart-styles"></style><google-chart-loader id="loader" type="[[type]]"></google-chart-loader><div id="chartdiv"></div></template></dom-module><script>(function(){'use strict';Polymer({is:'google-chart',properties:{type:{type:String,value:'column',observer:'_typeChanged'},events:{type:Array,value:function(){return[]}},options:{type:Object},cols:{type:Array,observer:'_rowsOrColumnsChanged'},rows:{type:Array,observer:'_rowsOrColumnsChanged'},data:{type:String,observer:'_dataChanged'},view:{type:Object,observer:'_viewChanged'},selection:{type:Array,notify:!0,observer:'_setSelection'},drawn:{type:Boolean,readOnly:!0,value:!1}},observers:['_draw(_chart, _dataView)','_subOptionChanged(options.*)'],listeners:{"google-chart-select":'_updateSelection',"google-chart-ready":'_onChartReady'},_chart:null,_dataView:null,_selection:null,_typeChanged:function(){this.$.loader.create(this.type,this.$.chartdiv).then(function(a){var b=this.$.loader;Object.keys(this.events.concat(['select','ready']).reduce(function(a,b){return a[b]=!0,a},{})).forEach(function(c){b.fireOnChartEvent(a,c)}),this._setDrawn(!1),this._chart=a}.bind(this))},_subOptionChanged:function(a){this.options=a.base,this.debounce('optionChangeRedraw',function(){this.redraw()},5)},_setSelection:function(){this.drawn&&this.selection&&this.selection!==this._selection&&(this._chart.setSelection&&this._chart.setSelection(this.selection),this._selection=this.selection)},_updateSelection:function(){this.selection=this._selection=this._chart.getSelection()},_onChartReady:function(){this._setDrawn(!0),this._selection=null,this._setSelection()},redraw:function(){this._chart&&this._dataView&&this._draw(this._chart,this._dataView)},_draw:function(a,b){if(null!=a&&null!=b)try{this._setDrawn(!1),a.draw(b,this.options||{})}catch(a){this.$.chartdiv.innerHTML=a}},get imageURI(){return this._chart?this._chart.getImageURI():null},_viewChanged:function(a){a&&(this._dataView=a)},_rowsOrColumnsChanged:function(){var a=this.rows,b=this.cols;a&&b&&this.$.loader.dataTable().then(function(c){return b.forEach(function(a){c.addColumn(a)}),c.addRows(a),c}.bind(this)).then(this.$.loader.dataView.bind(this.$.loader)).then(function(a){this._dataView=a}.bind(this)).catch(function(a){this.$.chartdiv.innerHTML=a}.bind(this))},_dataChanged:function(a){var b;if(a){var c=!1;try{a=JSON.parse(a)}catch(b){c='string'==typeof a||a instanceof String}if(c){var d=document.createElement('iron-request');b=d.send({url:a,handleAs:'json'}).then(function(a){return a.response})}else b=Promise.resolve(a);b.then(this.$.loader.dataTable.bind(this.$.loader)).then(this.$.loader.dataView.bind(this.$.loader)).then(function(a){this._dataView=a}.bind(this))}}})})();</script></div><dom-module id="fsn-telemetry-view"><template is="dom-bind"><style include="shared-styles">:host{display:block;padding:10px;}google-chart{width:100%;}</style><iron-ajax auto="" id="apiAjax" url="{{url}}" handle-as="json" last-response="{{apiData}}"></iron-ajax><paper-card class="card" heading="Live Altitude Data"><google-chart id="chart" type="line" options="{&quot;title&quot;: &quot;Live Telemetry Graph&quot;, &quot;interpolateNulls&quot;: true }" cols="[{&quot;label&quot;:&quot;time&quot;, &quot;type&quot;:&quot;datetime&quot;}, {&quot;label&quot;:&quot;Altitude&quot;, &quot;type&quot;:&quot;number&quot;}, {&quot;label&quot;:&quot;Groundspeed&quot;, &quot;type&quot;:&quot;number&quot;}]" rows="{{chartData}}"></google-chart><paper-card-actions><paper-input value="{{transponder}}" label="Transponder"></paper-input></paper-card-actions></paper-card></template><script>class FsnTelemetryView extends Polymer.Element{static get is(){return'fsn-telemetry-view'}static get properties(){return{transponder:{type:String,value:'',notify:!0},where:{type:String},apiData:{type:Object,value:{}},chartData:{type:Array,value:[]},lastSeen:{type:Object},url:{type:String,computed:'_computeUrl(transponder, lastSeen)'}}}static get observers(){return['_handleResponse(apiData)']}ready(){super.ready()}connectedCallback(){super.connectedCallback();var a=this.$.apiAjax;setInterval(()=>{a.generateRequest()},1e4)}_computeUrl(a){var b=['{"transponder":"'+a+'"}'];return b.push('{"_created":{"$gt":"'+moment().subtract(10,'minutes').format('ddd, D MMM YYYY HH:mm:ss [GMT]')+'"}}'),!1,['https://fsn-flight-data.herokuapp.com/position-reports?where=','{"$and":['+b.join(',')+']}'].join('')}_handleResponse(a){if(a._items){a=a._items,this.chartData=[];for(var b=0,c=a.length;b<c;b++){let c=moment(a[b].timestamp);(!this.lastSeen||!this.lastSeen>c)&&(this.lastSeen=c),this.chartData.push([c.toDate(),a[b].altitude,a[b].groundspeed])}}}}window.customElements.define(FsnTelemetryView.is,FsnTelemetryView);</script></dom-module></body></html>